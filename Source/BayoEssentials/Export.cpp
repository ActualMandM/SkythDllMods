#include "Export.h"

#define DEFINE_EXPORT(NAME) \
    static FARPROC s_##NAME; \
    \
    extern "C" void __declspec(dllexport, naked) NAME() \
    { \
        __asm \
        { \
            jmp [s_##NAME] \
        } \
    }

DEFINE_EXPORT(mciExecute);
DEFINE_EXPORT(CloseDriver);
DEFINE_EXPORT(DefDriverProc);
DEFINE_EXPORT(DriverCallback);
DEFINE_EXPORT(DrvGetModuleHandle);
DEFINE_EXPORT(GetDriverModuleHandle);
DEFINE_EXPORT(NotifyCallbackData);
DEFINE_EXPORT(OpenDriver);
DEFINE_EXPORT(PlaySound);
DEFINE_EXPORT(PlaySoundA);
DEFINE_EXPORT(PlaySoundW);
DEFINE_EXPORT(SendDriverMessage);
DEFINE_EXPORT(WOW32DriverCallback);
DEFINE_EXPORT(WOW32ResolveMultiMediaHandle);
DEFINE_EXPORT(WOWAppExit);
DEFINE_EXPORT(aux32Message);
DEFINE_EXPORT(auxGetDevCapsA);
DEFINE_EXPORT(auxGetDevCapsW);
DEFINE_EXPORT(auxGetNumDevs);
DEFINE_EXPORT(auxGetVolume);
DEFINE_EXPORT(auxOutMessage);
DEFINE_EXPORT(auxSetVolume);
DEFINE_EXPORT(joy32Message);
DEFINE_EXPORT(joyConfigChanged);
DEFINE_EXPORT(joyGetDevCapsA);
DEFINE_EXPORT(joyGetDevCapsW);
DEFINE_EXPORT(joyGetNumDevs);
DEFINE_EXPORT(joyGetPos);
DEFINE_EXPORT(joyGetPosEx);
DEFINE_EXPORT(joyGetThreshold);
DEFINE_EXPORT(joyReleaseCapture);
DEFINE_EXPORT(joySetCapture);
DEFINE_EXPORT(joySetThreshold);
DEFINE_EXPORT(mci32Message);
DEFINE_EXPORT(mciDriverNotify);
DEFINE_EXPORT(mciDriverYield);
DEFINE_EXPORT(mciFreeCommandResource);
DEFINE_EXPORT(mciGetCreatorTask);
DEFINE_EXPORT(mciGetDeviceIDA);
DEFINE_EXPORT(mciGetDeviceIDFromElementIDA);
DEFINE_EXPORT(mciGetDeviceIDFromElementIDW);
DEFINE_EXPORT(mciGetDeviceIDW);
DEFINE_EXPORT(mciGetDriverData);
DEFINE_EXPORT(mciGetErrorStringA);
DEFINE_EXPORT(mciGetErrorStringW);
DEFINE_EXPORT(mciGetYieldProc);
DEFINE_EXPORT(mciLoadCommandResource);
DEFINE_EXPORT(mciSendCommandA);
DEFINE_EXPORT(mciSendCommandW);
DEFINE_EXPORT(mciSendStringA);
DEFINE_EXPORT(mciSendStringW);
DEFINE_EXPORT(mciSetDriverData);
DEFINE_EXPORT(mciSetYieldProc);
DEFINE_EXPORT(mid32Message);
DEFINE_EXPORT(midiConnect);
DEFINE_EXPORT(midiDisconnect);
DEFINE_EXPORT(midiInAddBuffer);
DEFINE_EXPORT(midiInClose);
DEFINE_EXPORT(midiInGetDevCapsA);
DEFINE_EXPORT(midiInGetDevCapsW);
DEFINE_EXPORT(midiInGetErrorTextA);
DEFINE_EXPORT(midiInGetErrorTextW);
DEFINE_EXPORT(midiInGetID);
DEFINE_EXPORT(midiInGetNumDevs);
DEFINE_EXPORT(midiInMessage);
DEFINE_EXPORT(midiInOpen);
DEFINE_EXPORT(midiInPrepareHeader);
DEFINE_EXPORT(midiInReset);
DEFINE_EXPORT(midiInStart);
DEFINE_EXPORT(midiInStop);
DEFINE_EXPORT(midiInUnprepareHeader);
DEFINE_EXPORT(midiOutCacheDrumPatches);
DEFINE_EXPORT(midiOutCachePatches);
DEFINE_EXPORT(midiOutClose);
DEFINE_EXPORT(midiOutGetDevCapsA);
DEFINE_EXPORT(midiOutGetDevCapsW);
DEFINE_EXPORT(midiOutGetErrorTextA);
DEFINE_EXPORT(midiOutGetErrorTextW);
DEFINE_EXPORT(midiOutGetID);
DEFINE_EXPORT(midiOutGetNumDevs);
DEFINE_EXPORT(midiOutGetVolume);
DEFINE_EXPORT(midiOutLongMsg);
DEFINE_EXPORT(midiOutMessage);
DEFINE_EXPORT(midiOutOpen);
DEFINE_EXPORT(midiOutPrepareHeader);
DEFINE_EXPORT(midiOutReset);
DEFINE_EXPORT(midiOutSetVolume);
DEFINE_EXPORT(midiOutShortMsg);
DEFINE_EXPORT(midiOutUnprepareHeader);
DEFINE_EXPORT(midiStreamClose);
DEFINE_EXPORT(midiStreamOpen);
DEFINE_EXPORT(midiStreamOut);
DEFINE_EXPORT(midiStreamPause);
DEFINE_EXPORT(midiStreamPosition);
DEFINE_EXPORT(midiStreamProperty);
DEFINE_EXPORT(midiStreamRestart);
DEFINE_EXPORT(midiStreamStop);
DEFINE_EXPORT(mixerClose);
DEFINE_EXPORT(mixerGetControlDetailsA);
DEFINE_EXPORT(mixerGetControlDetailsW);
DEFINE_EXPORT(mixerGetDevCapsA);
DEFINE_EXPORT(mixerGetDevCapsW);
DEFINE_EXPORT(mixerGetID);
DEFINE_EXPORT(mixerGetLineControlsA);
DEFINE_EXPORT(mixerGetLineControlsW);
DEFINE_EXPORT(mixerGetLineInfoA);
DEFINE_EXPORT(mixerGetLineInfoW);
DEFINE_EXPORT(mixerGetNumDevs);
DEFINE_EXPORT(mixerMessage);
DEFINE_EXPORT(mixerOpen);
DEFINE_EXPORT(mixerSetControlDetails);
DEFINE_EXPORT(mmDrvInstall);
DEFINE_EXPORT(mmGetCurrentTask);
DEFINE_EXPORT(mmTaskBlock);
DEFINE_EXPORT(mmTaskCreate);
DEFINE_EXPORT(mmTaskSignal);
DEFINE_EXPORT(mmTaskYield);
DEFINE_EXPORT(mmioAdvance);
DEFINE_EXPORT(mmioAscend);
DEFINE_EXPORT(mmioClose);
DEFINE_EXPORT(mmioCreateChunk);
DEFINE_EXPORT(mmioDescend);
DEFINE_EXPORT(mmioFlush);
DEFINE_EXPORT(mmioGetInfo);
DEFINE_EXPORT(mmioInstallIOProcA);
DEFINE_EXPORT(mmioInstallIOProcW);
DEFINE_EXPORT(mmioOpenA);
DEFINE_EXPORT(mmioOpenW);
DEFINE_EXPORT(mmioRead);
DEFINE_EXPORT(mmioRenameA);
DEFINE_EXPORT(mmioRenameW);
DEFINE_EXPORT(mmioSeek);
DEFINE_EXPORT(mmioSendMessage);
DEFINE_EXPORT(mmioSetBuffer);
DEFINE_EXPORT(mmioSetInfo);
DEFINE_EXPORT(mmioStringToFOURCCA);
DEFINE_EXPORT(mmioStringToFOURCCW);
DEFINE_EXPORT(mmioWrite);
DEFINE_EXPORT(mmsystemGetVersion);
DEFINE_EXPORT(mod32Message);
DEFINE_EXPORT(mxd32Message);
DEFINE_EXPORT(sndPlaySoundA);
DEFINE_EXPORT(sndPlaySoundW);
DEFINE_EXPORT(tid32Message);
DEFINE_EXPORT(timeBeginPeriod);
DEFINE_EXPORT(timeEndPeriod);
DEFINE_EXPORT(timeGetDevCaps);
DEFINE_EXPORT(timeGetSystemTime);
DEFINE_EXPORT(timeGetTime);
DEFINE_EXPORT(timeKillEvent);
DEFINE_EXPORT(timeSetEvent);
DEFINE_EXPORT(waveInAddBuffer);
DEFINE_EXPORT(waveInClose);
DEFINE_EXPORT(waveInGetDevCapsA);
DEFINE_EXPORT(waveInGetDevCapsW);
DEFINE_EXPORT(waveInGetErrorTextA);
DEFINE_EXPORT(waveInGetErrorTextW);
DEFINE_EXPORT(waveInGetID);
DEFINE_EXPORT(waveInGetNumDevs);
DEFINE_EXPORT(waveInGetPosition);
DEFINE_EXPORT(waveInMessage);
DEFINE_EXPORT(waveInOpen);
DEFINE_EXPORT(waveInPrepareHeader);
DEFINE_EXPORT(waveInReset);
DEFINE_EXPORT(waveInStart);
DEFINE_EXPORT(waveInStop);
DEFINE_EXPORT(waveInUnprepareHeader);
DEFINE_EXPORT(waveOutBreakLoop);
DEFINE_EXPORT(waveOutClose);
DEFINE_EXPORT(waveOutGetDevCapsA);
DEFINE_EXPORT(waveOutGetDevCapsW);
DEFINE_EXPORT(waveOutGetErrorTextA);
DEFINE_EXPORT(waveOutGetErrorTextW);
DEFINE_EXPORT(waveOutGetID);
DEFINE_EXPORT(waveOutGetNumDevs);
DEFINE_EXPORT(waveOutGetPitch);
DEFINE_EXPORT(waveOutGetPlaybackRate);
DEFINE_EXPORT(waveOutGetPosition);
DEFINE_EXPORT(waveOutGetVolume);
DEFINE_EXPORT(waveOutMessage);
DEFINE_EXPORT(waveOutOpen);
DEFINE_EXPORT(waveOutPause);
DEFINE_EXPORT(waveOutPrepareHeader);
DEFINE_EXPORT(waveOutReset);
DEFINE_EXPORT(waveOutRestart);
DEFINE_EXPORT(waveOutSetPitch);
DEFINE_EXPORT(waveOutSetPlaybackRate);
DEFINE_EXPORT(waveOutSetVolume);
DEFINE_EXPORT(waveOutUnprepareHeader);
DEFINE_EXPORT(waveOutWrite);
DEFINE_EXPORT(wid32Message);
DEFINE_EXPORT(wod32Message);

#define SET_EXPORT(NAME) \
    s_##NAME = GetProcAddress(hModule, #NAME)

void Export::init()
{
    wchar_t filePath[MAX_PATH];
    GetSystemDirectoryW(filePath, _countof(filePath));
    wcscat_s(filePath, L"\\winmm.dll");

    HMODULE hModule = LoadLibraryW(filePath);

    SET_EXPORT(PlaySoundA);
    SET_EXPORT(mciExecute);
    SET_EXPORT(CloseDriver);
    SET_EXPORT(DefDriverProc);
    SET_EXPORT(DriverCallback);
    SET_EXPORT(DrvGetModuleHandle);
    SET_EXPORT(GetDriverModuleHandle);
    SET_EXPORT(NotifyCallbackData);
    SET_EXPORT(OpenDriver);
    SET_EXPORT(PlaySound);
    SET_EXPORT(PlaySoundA);
    SET_EXPORT(PlaySoundW);
    SET_EXPORT(SendDriverMessage);
    SET_EXPORT(WOW32DriverCallback);
    SET_EXPORT(WOW32ResolveMultiMediaHandle);
    SET_EXPORT(WOWAppExit);
    SET_EXPORT(aux32Message);
    SET_EXPORT(auxGetDevCapsA);
    SET_EXPORT(auxGetDevCapsW);
    SET_EXPORT(auxGetNumDevs);
    SET_EXPORT(auxGetVolume);
    SET_EXPORT(auxOutMessage);
    SET_EXPORT(auxSetVolume);
    SET_EXPORT(joy32Message);
    SET_EXPORT(joyConfigChanged);
    SET_EXPORT(joyGetDevCapsA);
    SET_EXPORT(joyGetDevCapsW);
    SET_EXPORT(joyGetNumDevs);
    SET_EXPORT(joyGetPos);
    SET_EXPORT(joyGetPosEx);
    SET_EXPORT(joyGetThreshold);
    SET_EXPORT(joyReleaseCapture);
    SET_EXPORT(joySetCapture);
    SET_EXPORT(joySetThreshold);
    SET_EXPORT(mci32Message);
    SET_EXPORT(mciDriverNotify);
    SET_EXPORT(mciDriverYield);
    SET_EXPORT(mciFreeCommandResource);
    SET_EXPORT(mciGetCreatorTask);
    SET_EXPORT(mciGetDeviceIDA);
    SET_EXPORT(mciGetDeviceIDFromElementIDA);
    SET_EXPORT(mciGetDeviceIDFromElementIDW);
    SET_EXPORT(mciGetDeviceIDW);
    SET_EXPORT(mciGetDriverData);
    SET_EXPORT(mciGetErrorStringA);
    SET_EXPORT(mciGetErrorStringW);
    SET_EXPORT(mciGetYieldProc);
    SET_EXPORT(mciLoadCommandResource);
    SET_EXPORT(mciSendCommandA);
    SET_EXPORT(mciSendCommandW);
    SET_EXPORT(mciSendStringA);
    SET_EXPORT(mciSendStringW);
    SET_EXPORT(mciSetDriverData);
    SET_EXPORT(mciSetYieldProc);
    SET_EXPORT(mid32Message);
    SET_EXPORT(midiConnect);
    SET_EXPORT(midiDisconnect);
    SET_EXPORT(midiInAddBuffer);
    SET_EXPORT(midiInClose);
    SET_EXPORT(midiInGetDevCapsA);
    SET_EXPORT(midiInGetDevCapsW);
    SET_EXPORT(midiInGetErrorTextA);
    SET_EXPORT(midiInGetErrorTextW);
    SET_EXPORT(midiInGetID);
    SET_EXPORT(midiInGetNumDevs);
    SET_EXPORT(midiInMessage);
    SET_EXPORT(midiInOpen);
    SET_EXPORT(midiInPrepareHeader);
    SET_EXPORT(midiInReset);
    SET_EXPORT(midiInStart);
    SET_EXPORT(midiInStop);
    SET_EXPORT(midiInUnprepareHeader);
    SET_EXPORT(midiOutCacheDrumPatches);
    SET_EXPORT(midiOutCachePatches);
    SET_EXPORT(midiOutClose);
    SET_EXPORT(midiOutGetDevCapsA);
    SET_EXPORT(midiOutGetDevCapsW);
    SET_EXPORT(midiOutGetErrorTextA);
    SET_EXPORT(midiOutGetErrorTextW);
    SET_EXPORT(midiOutGetID);
    SET_EXPORT(midiOutGetNumDevs);
    SET_EXPORT(midiOutGetVolume);
    SET_EXPORT(midiOutLongMsg);
    SET_EXPORT(midiOutMessage);
    SET_EXPORT(midiOutOpen);
    SET_EXPORT(midiOutPrepareHeader);
    SET_EXPORT(midiOutReset);
    SET_EXPORT(midiOutSetVolume);
    SET_EXPORT(midiOutShortMsg);
    SET_EXPORT(midiOutUnprepareHeader);
    SET_EXPORT(midiStreamClose);
    SET_EXPORT(midiStreamOpen);
    SET_EXPORT(midiStreamOut);
    SET_EXPORT(midiStreamPause);
    SET_EXPORT(midiStreamPosition);
    SET_EXPORT(midiStreamProperty);
    SET_EXPORT(midiStreamRestart);
    SET_EXPORT(midiStreamStop);
    SET_EXPORT(mixerClose);
    SET_EXPORT(mixerGetControlDetailsA);
    SET_EXPORT(mixerGetControlDetailsW);
    SET_EXPORT(mixerGetDevCapsA);
    SET_EXPORT(mixerGetDevCapsW);
    SET_EXPORT(mixerGetID);
    SET_EXPORT(mixerGetLineControlsA);
    SET_EXPORT(mixerGetLineControlsW);
    SET_EXPORT(mixerGetLineInfoA);
    SET_EXPORT(mixerGetLineInfoW);
    SET_EXPORT(mixerGetNumDevs);
    SET_EXPORT(mixerMessage);
    SET_EXPORT(mixerOpen);
    SET_EXPORT(mixerSetControlDetails);
    SET_EXPORT(mmDrvInstall);
    SET_EXPORT(mmGetCurrentTask);
    SET_EXPORT(mmTaskBlock);
    SET_EXPORT(mmTaskCreate);
    SET_EXPORT(mmTaskSignal);
    SET_EXPORT(mmTaskYield);
    SET_EXPORT(mmioAdvance);
    SET_EXPORT(mmioAscend);
    SET_EXPORT(mmioClose);
    SET_EXPORT(mmioCreateChunk);
    SET_EXPORT(mmioDescend);
    SET_EXPORT(mmioFlush);
    SET_EXPORT(mmioGetInfo);
    SET_EXPORT(mmioInstallIOProcA);
    SET_EXPORT(mmioInstallIOProcW);
    SET_EXPORT(mmioOpenA);
    SET_EXPORT(mmioOpenW);
    SET_EXPORT(mmioRead);
    SET_EXPORT(mmioRenameA);
    SET_EXPORT(mmioRenameW);
    SET_EXPORT(mmioSeek);
    SET_EXPORT(mmioSendMessage);
    SET_EXPORT(mmioSetBuffer);
    SET_EXPORT(mmioSetInfo);
    SET_EXPORT(mmioStringToFOURCCA);
    SET_EXPORT(mmioStringToFOURCCW);
    SET_EXPORT(mmioWrite);
    SET_EXPORT(mmsystemGetVersion);
    SET_EXPORT(mod32Message);
    SET_EXPORT(mxd32Message);
    SET_EXPORT(sndPlaySoundA);
    SET_EXPORT(sndPlaySoundW);
    SET_EXPORT(tid32Message);
    SET_EXPORT(timeBeginPeriod);
    SET_EXPORT(timeEndPeriod);
    SET_EXPORT(timeGetDevCaps);
    SET_EXPORT(timeGetSystemTime);
    SET_EXPORT(timeGetTime);
    SET_EXPORT(timeKillEvent);
    SET_EXPORT(timeSetEvent);
    SET_EXPORT(waveInAddBuffer);
    SET_EXPORT(waveInClose);
    SET_EXPORT(waveInGetDevCapsA);
    SET_EXPORT(waveInGetDevCapsW);
    SET_EXPORT(waveInGetErrorTextA);
    SET_EXPORT(waveInGetErrorTextW);
    SET_EXPORT(waveInGetID);
    SET_EXPORT(waveInGetNumDevs);
    SET_EXPORT(waveInGetPosition);
    SET_EXPORT(waveInMessage);
    SET_EXPORT(waveInOpen);
    SET_EXPORT(waveInPrepareHeader);
    SET_EXPORT(waveInReset);
    SET_EXPORT(waveInStart);
    SET_EXPORT(waveInStop);
    SET_EXPORT(waveInUnprepareHeader);
    SET_EXPORT(waveOutBreakLoop);
    SET_EXPORT(waveOutClose);
    SET_EXPORT(waveOutGetDevCapsA);
    SET_EXPORT(waveOutGetDevCapsW);
    SET_EXPORT(waveOutGetErrorTextA);
    SET_EXPORT(waveOutGetErrorTextW);
    SET_EXPORT(waveOutGetID);
    SET_EXPORT(waveOutGetNumDevs);
    SET_EXPORT(waveOutGetPitch);
    SET_EXPORT(waveOutGetPlaybackRate);
    SET_EXPORT(waveOutGetPosition);
    SET_EXPORT(waveOutGetVolume);
    SET_EXPORT(waveOutMessage);
    SET_EXPORT(waveOutOpen);
    SET_EXPORT(waveOutPause);
    SET_EXPORT(waveOutPrepareHeader);
    SET_EXPORT(waveOutReset);
    SET_EXPORT(waveOutRestart);
    SET_EXPORT(waveOutSetPitch);
    SET_EXPORT(waveOutSetPlaybackRate);
    SET_EXPORT(waveOutSetVolume);
    SET_EXPORT(waveOutUnprepareHeader);
    SET_EXPORT(waveOutWrite);
    SET_EXPORT(wid32Message);
    SET_EXPORT(wod32Message);
}